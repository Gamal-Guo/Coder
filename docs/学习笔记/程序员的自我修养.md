# 程序员的自我修养

## 为什么每个设备需要IO控制器？

早期的计算机没有很复杂的图形功能，CPU的核心频率也不高，跟内存的频率一样，它们都是直接连接在同一个总线(Bus). 上的。 由于I/O设备诸如显示设备、键盘、软盘和磁盘等速度与CPU和内存相比还是慢很多，当时也没有复杂的图形设备，显示设备大多是只能输出字符的终端。**为了协调I/O设备与总线之间的速度，也为了能够让CPU能够和I/O设备进行通信，一般每个设备都会有一个相应的I/O 控制器。**

## 为什么计算机硬件结构需要北桥和南桥？

由于CPU核心频率的提升，导致内存跟不上CPU的速度，于是产生了与内存频率一致的系统总线，而CPU采用倍频的方式与系统总线进行通信。接着随着图形化的操作系统普及，特别是3D游戏和多媒体的发展，使得图形芯片需要跟CPU和内存之间大量交换数据，慢速的I/O总线已经无法满足图形设备的巨大需求。为了协调CPU、内存和高速的图形设备，人们专门设计了一个高速的北桥芯片，以便它们之间能够高速地交换数据。

由于北桥运行的速度非常高，所有相对低速的设备如果全都直接连接在北桥上，北桥既须处理高速设备，又须处理低速设备，设计就会十分复杂。于是人们又设计了专门处理低速设备的南桥(Southbridge) 芯片，磁盘、USB、 键盘、鼠标等设备都连接在南桥上，由南桥将它们汇总后连接到北桥上。20世纪90年代的PC机在系统总线上采用的是PCI结构，而在低速设备上采用的ISA总线，采用PCI/ISA及南北桥设计的硬件构架如下图所示。

<img src="/Users/guoguangming/Projects/CppInterview/image/image-20220301084113178.png" alt="image-20220301084113178" style="zoom:67%;" />

位于中间是连接所有高速芯片的北桥(Northbridge, PCI Bridge),它就像人的心脏，连接并驱动身体的各个部位;它的左边是CPU,负责所有的控制和运算，就像人的大脑。北桥还连接着几个高速部件，包括左边的内存和下面的PCI总线。PCI的速度最高为133 MHz，它还是不能满足人们的需求，于是人们又发明了AGP、PCI Express等诸多总线结构和相应控制芯片。虽然硬件结构看似越来越复杂，但实际上它
还是没有脱离最初的CPU、内存，以及I/O的基本结构。

## 计算机软件体系结构

**计算机科学领域的任何问题都可以通过增加一个间接的中间层来解决。**

系统软件这个概念其实比较模糊,传统意义上一般将用于管理计算机本身的软件称为系统软件，以区别普通的应用程序。系统软件可以分成两块，一块是平台性的，比如操作系统内核、驱动程序、运行库和数以千计的系统工具；另外一块是用于程序开发的，比如编译器、
汇编器、链接器等开发工具和开发库。

<img src="/Users/guoguangming/Projects/CppInterview/image/image-20220301085835854.png" alt="image-20220301085835854"  />

我们的软件体系中，位于最上层的是应用程序,比如我们平时用到的网络浏览器、Email客户端、多媒体播放器、图片浏览器等。从整个层次结构上来看，开发工具与应用程序是属于同一一个层次的,因为它们都使用一个接口, 那就是操作系统应用程序编程接口(Aplication
Programming Interface).应用程序接口的提供者是运行库，什么样的运行库提供什么样的API，比如Linux下的Glibc库提供POSIX的API; Windows 的运行库提供Windows API。最常见的32位Windows提供的API又被称为Win32。

运行库使用操作系统提供的系统调用接口( System call Interface)，系统调用接口在实现中往往以软件中断( Software Interrupt) 的方式提供，比如Linux使用0x80号中断作为系统调用接口，Windows 使用0x2E号中断作为系统调用接口(从Windows XP Sp2开始，Windows开始采用一种新的系统调用方式)。

## 物理地址空间与虚拟地址空间

**物理地址空间**是实实在在存在的，存在于计算机中，而且对于每一台计算机来说只有唯一的一个, 你可以把物理空间想象成物理内存，比如你的计算机用的是Intel的Pentium 4的处理器，那么它是32位的机器，即计算机地址线有32条(实际上是36条地址线，不过我们暂时认为它只是32条)，那么物理空间就有4GB。但是你的计算机上只装了512MB的内存，那么其实物理地址的真正有效部分只有0x0000000~
0x1FFFFF，其他部分都是无效的(实际上还有一些外部I/O设备映射到物理空间的，也是有效的，但是我们暂时无视其存在)。

**虚拟地址空间**是指虚拟的、人们想象出来的地址空间，其实它并不存在，每个进程都有自己独立的虚拟空间，而且每个进程只能访问白己的地址空间，这样就有效地做到了进程的隔离。

## 为什么需要虚拟地址空间？



